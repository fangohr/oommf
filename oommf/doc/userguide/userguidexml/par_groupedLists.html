<!DOCTYPE html><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>17.3.3 Specify Conventions‣ 17.3 MIF 2.1 ‣ Chapter 17 Problem Specification File Formats (MIF) ‣ OOMMF User’s Guide</title>
<!--Generated by LaTeXML (version 0.8.6) http://dlmf.nist.gov/LaTeXML/.-->
<!--Document created on September 30, 2022.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link rel="stylesheet" href="oommf.css" type="text/css">
<link rel="stylesheet" href="oommf-report.css" type="text/css">
<link rel="stylesheet" href="oommf-tweakfonts.css" type="text/css">
<link rel="stylesheet" href="oommf-navbar.css" type="text/css">
<script src="LaTeXML-maybeMathjax.js" type="text/javascript"></script>
<link rel="up" href="sec_mif2format.html" title="17.3 MIF 2.1 ‣ Chapter 17 Problem Specification File Formats (MIF) ‣ OOMMF User’s Guide">
<link rel="up up" href="sec_mifformat.html" title="Chapter 17 Problem Specification File Formats (MIF) ‣ OOMMF User’s Guide">
<link rel="up up up" href="userguide.html" title="OOMMF User’s Guide">
<link rel="start" href="userguide.html" title="OOMMF User’s Guide">
<link rel="prev" href="sec_mif2ExtensionCommands.html" title="17.3.2 MIF 2.1 Extension Commands ‣ 17.3 MIF 2.1 ‣ Chapter 17 Problem Specification File Formats (MIF) ‣ OOMMF User’s Guide">
<link rel="next" href="sec_varSubst.html" title="17.3.4 Variable Substitution ‣ 17.3 MIF 2.1 ‣ Chapter 17 Problem Specification File Formats (MIF) ‣ OOMMF User’s Guide">
<link rel="subsection" href="sec_mif2overview.html" title="17.3.1 MIF 2.1 File Overview ‣ 17.3 MIF 2.1 ‣ Chapter 17 Problem Specification File Formats (MIF) ‣ OOMMF User’s Guide">
<link rel="subsection" href="sec_mif2ExtensionCommands.html" title="17.3.2 MIF 2.1 Extension Commands ‣ 17.3 MIF 2.1 ‣ Chapter 17 Problem Specification File Formats (MIF) ‣ OOMMF User’s Guide">
<link rel="subsection" href="sec_varSubst.html" title="17.3.4 Variable Substitution ‣ 17.3 MIF 2.1 ‣ Chapter 17 Problem Specification File Formats (MIF) ‣ OOMMF User’s Guide">
<link rel="subsection" href="sec_mif2sample.html" title="17.3.5 Sample MIF 2.1 File ‣ 17.3 MIF 2.1 ‣ Chapter 17 Problem Specification File Formats (MIF) ‣ OOMMF User’s Guide">
<link rel="section" href="sec_mif1format.html" title="17.1 MIF 1.1 ‣ Chapter 17 Problem Specification File Formats (MIF) ‣ OOMMF User’s Guide">
<link rel="section" href="sec_mif12format.html" title="17.2 MIF 1.2 ‣ Chapter 17 Problem Specification File Formats (MIF) ‣ OOMMF User’s Guide">
<link rel="section" href="sec_mif2format.html" title="17.3 MIF 2.1 ‣ Chapter 17 Problem Specification File Formats (MIF) ‣ OOMMF User’s Guide">
<link rel="section" href="sec_mif22format.html" title="17.4 MIF 2.2 ‣ Chapter 17 Problem Specification File Formats (MIF) ‣ OOMMF User’s Guide">
<link rel="section" href="sec_mif2tips.html" title="17.5 Tips for writing MIF 2.x files ‣ Chapter 17 Problem Specification File Formats (MIF) ‣ OOMMF User’s Guide">
<link rel="chapter" href="disclaimer.html" title="Disclaimer ‣ OOMMF User’s Guide">
<link rel="chapter" href="sec_overview.html" title="Chapter 1 Overview of OOMMF ‣ OOMMF User’s Guide">
<link rel="chapter" href="sec_install.html" title="Chapter 2 Installation ‣ OOMMF User’s Guide">
<link rel="chapter" href="sec_quickstart.html" title="Chapter 3 Quick Start: Example OOMMF Session ‣ OOMMF User’s Guide">
<link rel="chapter" href="sec_arch.html" title="Chapter 4 OOMMF Architecture Overview ‣ OOMMF User’s Guide">
<link rel="chapter" href="sec_cll.html" title="Chapter 5 Command Line Launching ‣ OOMMF User’s Guide">
<link rel="chapter" href="sec_mmlaunch.html" title="Chapter 6 OOMMF Launcher/Control Interface: mmLaunch ‣ OOMMF User’s Guide">
<link rel="chapter" href="sec_oxs.html" title="Chapter 7 OOMMF eXtensible Solver ‣ OOMMF User’s Guide">
<link rel="chapter" href="sec_mmprobed.html" title="Chapter 8 Micromagnetic Problem Editor: mmProbEd ‣ OOMMF User’s Guide">
<link rel="chapter" href="sec_filesource.html" title="Chapter 9 Micromagnetic Problem File Source: FileSource ‣ OOMMF User’s Guide">
<link rel="chapter" href="sec_mmsolve.html" title="Chapter 10 The 2D Micromagnetic Solver ‣ OOMMF User’s Guide">
<link rel="chapter" href="sec_mmdatatable.html" title="Chapter 11 Data Table Display: mmDataTable ‣ OOMMF User’s Guide">
<link rel="chapter" href="sec_mmgraph.html" title="Chapter 12 Data Graph Display: mmGraph ‣ OOMMF User’s Guide">
<link rel="chapter" href="html_mmdispdatascale.html" title="Chapter 13 Vector Field Display: mmDisp ‣ OOMMF User’s Guide">
<link rel="chapter" href="sec_mmarchive.html" title="Chapter 14 Data Archive: mmArchive ‣ OOMMF User’s Guide">
<link rel="chapter" href="sec_mmhelp.html" title="Chapter 15 Documentation Viewer: mmHelp ‣ OOMMF User’s Guide">
<link rel="chapter" href="sec_cmdutils.html" title="Chapter 16 Command Line Utilities ‣ OOMMF User’s Guide">
<link rel="chapter" href="sec_mifformat.html" title="Chapter 17 Problem Specification File Formats (MIF) ‣ OOMMF User’s Guide">
<link rel="chapter" href="sec_odtformat.html" title="Chapter 18 Data Table File Format (ODT) ‣ OOMMF User’s Guide">
<link rel="chapter" href="sec_vfformats.html" title="Chapter 19 Vector Field File Format (OVF) ‣ OOMMF User’s Guide">
<link rel="chapter" href="sec_trouble.html" title="Chapter 20 Troubleshooting ‣ OOMMF User’s Guide">
<link rel="chapter" href="sec_credits.html" title="Chapter 21 Credits ‣ OOMMF User’s Guide">
<link rel="bibliography" href="bibliography.html" title="Bibliography ‣ OOMMF User’s Guide">
<link rel="index" href="index.html" title="Index ‣ OOMMF User’s Guide">
<meta name="keywords" lang="en" content="Oxs_Ext referencing (MIF), Specify attributes (MIF), Specify comments (MIF), Specify conventions (MIF), Specify initialization string (MIF), Specify support procs (MIF), Specify user scalar outputs (MIF), Tcl list, file, grouped lists (MIF), mask">
</head>
<body>
<nav class="ltx_page_navbar"><a href="userguide.html" title="OOMMF User’s Guide" class="ltx_ref" rel="start"><span class="ltx_text ltx_ref_title">OOMMF User’s Guide</span></a>
<div class="ltx_TOC">
<ul class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_chapter"><a href="disclaimer.html" title="Disclaimer ‣ OOMMF User’s Guide" class="ltx_ref"><span class="ltx_text ltx_ref_title">Disclaimer</span></a></li>
<li class="ltx_tocentry ltx_tocentry_chapter"><a href="sec_overview.html" title="Chapter 1 Overview of OOMMF ‣ OOMMF User’s Guide" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Overview of OOMMF</span></a></li>
<li class="ltx_tocentry ltx_tocentry_chapter"><a href="sec_install.html" title="Chapter 2 Installation ‣ OOMMF User’s Guide" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Installation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_chapter"><a href="sec_quickstart.html" title="Chapter 3 Quick Start: Example OOMMF Session ‣ OOMMF User’s Guide" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Quick Start: Example OOMMF Session</span></a></li>
<li class="ltx_tocentry ltx_tocentry_chapter"><a href="sec_arch.html" title="Chapter 4 OOMMF Architecture Overview ‣ OOMMF User’s Guide" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>OOMMF Architecture Overview</span></a></li>
<li class="ltx_tocentry ltx_tocentry_chapter"><a href="sec_cll.html" title="Chapter 5 Command Line Launching ‣ OOMMF User’s Guide" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Command Line Launching</span></a></li>
<li class="ltx_tocentry ltx_tocentry_chapter"><a href="sec_mmlaunch.html" title="Chapter 6 OOMMF Launcher/Control Interface: mmLaunch ‣ OOMMF User’s Guide" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>OOMMF Launcher/Control Interface: mmLaunch</span></a></li>
<li class="ltx_tocentry ltx_tocentry_chapter"><a href="sec_oxs.html" title="Chapter 7 OOMMF eXtensible Solver ‣ OOMMF User’s Guide" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7 </span>OOMMF eXtensible Solver</span></a></li>
<li class="ltx_tocentry ltx_tocentry_chapter"><a href="sec_mmprobed.html" title="Chapter 8 Micromagnetic Problem Editor: mmProbEd ‣ OOMMF User’s Guide" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">8 </span>Micromagnetic Problem Editor: mmProbEd</span></a></li>
<li class="ltx_tocentry ltx_tocentry_chapter"><a href="sec_filesource.html" title="Chapter 9 Micromagnetic Problem File Source: FileSource ‣ OOMMF User’s Guide" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">9 </span>Micromagnetic Problem File Source: FileSource</span></a></li>
<li class="ltx_tocentry ltx_tocentry_chapter"><a href="sec_mmsolve.html" title="Chapter 10 The 2D Micromagnetic Solver ‣ OOMMF User’s Guide" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">10 </span>The 2D Micromagnetic Solver</span></a></li>
<li class="ltx_tocentry ltx_tocentry_chapter"><a href="sec_mmdatatable.html" title="Chapter 11 Data Table Display: mmDataTable ‣ OOMMF User’s Guide" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">11 </span>Data Table Display: mmDataTable</span></a></li>
<li class="ltx_tocentry ltx_tocentry_chapter"><a href="sec_mmgraph.html" title="Chapter 12 Data Graph Display: mmGraph ‣ OOMMF User’s Guide" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">12 </span>Data Graph Display: mmGraph</span></a></li>
<li class="ltx_tocentry ltx_tocentry_chapter"><a href="html_mmdispdatascale.html" title="Chapter 13 Vector Field Display: mmDisp ‣ OOMMF User’s Guide" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">13 </span>Vector Field Display: mmDisp</span></a></li>
<li class="ltx_tocentry ltx_tocentry_chapter"><a href="sec_mmarchive.html" title="Chapter 14 Data Archive: mmArchive ‣ OOMMF User’s Guide" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">14 </span>Data Archive: mmArchive</span></a></li>
<li class="ltx_tocentry ltx_tocentry_chapter"><a href="sec_mmhelp.html" title="Chapter 15 Documentation Viewer: mmHelp ‣ OOMMF User’s Guide" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">15 </span>Documentation Viewer: mmHelp</span></a></li>
<li class="ltx_tocentry ltx_tocentry_chapter"><a href="sec_cmdutils.html" title="Chapter 16 Command Line Utilities ‣ OOMMF User’s Guide" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">16 </span>Command Line Utilities</span></a></li>
<li class="ltx_tocentry ltx_tocentry_chapter">
<a href="sec_mifformat.html" title="Chapter 17 Problem Specification File Formats (MIF) ‣ OOMMF User’s Guide" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">17 </span>Problem Specification File Formats (MIF)</span></a>
<ul class="ltx_toclist ltx_toclist_chapter">
<li class="ltx_tocentry ltx_tocentry_section"><a href="sec_mif1format.html" title="17.1 MIF 1.1 ‣ Chapter 17 Problem Specification File Formats (MIF) ‣ OOMMF User’s Guide" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">17.1 </span>MIF 1.1</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a href="sec_mif12format.html" title="17.2 MIF 1.2 ‣ Chapter 17 Problem Specification File Formats (MIF) ‣ OOMMF User’s Guide" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">17.2 </span>MIF 1.2</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a href="sec_mif2format.html" title="17.3 MIF 2.1 ‣ Chapter 17 Problem Specification File Formats (MIF) ‣ OOMMF User’s Guide" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">17.3 </span>MIF 2.1</span></a>
<ul class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a href="sec_mif2overview.html" title="17.3.1 MIF 2.1 File Overview ‣ 17.3 MIF 2.1 ‣ Chapter 17 Problem Specification File Formats (MIF) ‣ OOMMF User’s Guide" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">17.3.1 </span>MIF 2.1 File Overview</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a href="sec_mif2ExtensionCommands.html" title="17.3.2 MIF 2.1 Extension Commands ‣ 17.3 MIF 2.1 ‣ Chapter 17 Problem Specification File Formats (MIF) ‣ OOMMF User’s Guide" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">17.3.2 </span>MIF 2.1 Extension Commands</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection ltx_ref_self"><span class="ltx_ref ltx_ref_self"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">17.3.3 </span>Specify Conventions</span></span></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a href="sec_varSubst.html" title="17.3.4 Variable Substitution ‣ 17.3 MIF 2.1 ‣ Chapter 17 Problem Specification File Formats (MIF) ‣ OOMMF User’s Guide" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">17.3.4 </span>Variable Substitution</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a href="sec_mif2sample.html" title="17.3.5 Sample MIF 2.1 File ‣ 17.3 MIF 2.1 ‣ Chapter 17 Problem Specification File Formats (MIF) ‣ OOMMF User’s Guide" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">17.3.5 </span>Sample MIF 2.1 File</span></a></li>
</ul>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a href="sec_mif22format.html" title="17.4 MIF 2.2 ‣ Chapter 17 Problem Specification File Formats (MIF) ‣ OOMMF User’s Guide" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">17.4 </span>MIF 2.2</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a href="sec_mif2tips.html" title="17.5 Tips for writing MIF 2.x files ‣ Chapter 17 Problem Specification File Formats (MIF) ‣ OOMMF User’s Guide" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">17.5 </span>Tips for writing MIF 2.x files</span></a></li>
</ul>
</li>
<li class="ltx_tocentry ltx_tocentry_chapter"><a href="sec_odtformat.html" title="Chapter 18 Data Table File Format (ODT) ‣ OOMMF User’s Guide" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">18 </span>Data Table File Format (ODT)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_chapter"><a href="sec_vfformats.html" title="Chapter 19 Vector Field File Format (OVF) ‣ OOMMF User’s Guide" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">19 </span>Vector Field File Format (OVF)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_chapter"><a href="sec_trouble.html" title="Chapter 20 Troubleshooting ‣ OOMMF User’s Guide" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">20 </span>Troubleshooting</span></a></li>
<li class="ltx_tocentry ltx_tocentry_chapter"><a href="sec_credits.html" title="Chapter 21 Credits ‣ OOMMF User’s Guide" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">21 </span>Credits</span></a></li>
<li class="ltx_tocentry ltx_tocentry_bibliography"><a href="bibliography.html" title="Bibliography ‣ OOMMF User’s Guide" class="ltx_ref"><span class="ltx_text ltx_ref_title">Bibliography</span></a></li>
<li class="ltx_tocentry ltx_tocentry_index"><a href="index.html" title="Index ‣ OOMMF User’s Guide" class="ltx_ref"><span class="ltx_text ltx_ref_title">Index</span></a></li>
</ul>
</div>
</nav>
<div class="ltx_page_main">
<header class="ltx_page_header">
<div>
<a href="sec_mif2format.html" title="17.3 MIF 2.1 ‣ Chapter 17 Problem Specification File Formats (MIF) ‣ OOMMF User’s Guide" class="ltx_ref" rel="up"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">17.3 </span>MIF 2.1</span></a><a href="sec_mif2ExtensionCommands.html" title="17.3.2 MIF 2.1 Extension Commands ‣ 17.3 MIF 2.1 ‣ Chapter 17 Problem Specification File Formats (MIF) ‣ OOMMF User’s Guide" class="ltx_ref" rel="prev"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">17.3.2 </span>MIF 2.1 Extension Commands</span></a><a href="sec_varSubst.html" title="17.3.4 Variable Substitution ‣ 17.3 MIF 2.1 ‣ Chapter 17 Problem Specification File Formats (MIF) ‣ OOMMF User’s Guide" class="ltx_ref" rel="next"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">17.3.4 </span>Variable Substitution</span></a>
</div></header>
<div class="ltx_page_content">
<section class="ltx_subsection ltx_authors_1line">
<h1 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">17.3.3 </span>Specify Conventions</h1>

<div id="p1" class="ltx_para">
<p class="ltx_p">The Specify blocks in the input MIF file determine the collection
of <span class="ltx_text ltx_font_typewriter">Oxs_Ext</span> objects defining the Oxs simulation. As explained
above, the <a href="sec_mif2ExtensionCommands.html#html:specifyCmd" title="item Specify ‣ 17.3.2 MIF 2.1 Extension Commands ‣ 17.3 MIF 2.1 ‣ Chapter 17 Problem Specification File Formats (MIF) ‣ OOMMF User’s Guide" class="ltx_ref ltx_font_typewriter">Specify</a> command takes two
arguments, the name of the <span class="ltx_text ltx_font_typewriter">Oxs_Ext</span> object to create, and an
initialization string. The format of the initialization string can
be arbitrary, as determined by the author of the <span class="ltx_text ltx_font_typewriter">Oxs_Ext</span> class.
This section presents a number of recommended conventions which
<span class="ltx_text ltx_font_typewriter">Oxs_Ext</span> class authors are encouraged to follow. Any <span class="ltx_text ltx_font_typewriter">Oxs_Ext</span>
classes that don’t follow these conventions should make that fact
explicitly clear in their documentation.
Details on the standard <span class="ltx_text ltx_font_typewriter">Oxs_Ext</span> classes included with OOMMF can
be found in the
<a href="sec_oxs.html" title="Chapter 7 OOMMF eXtensible Solver ‣ OOMMF User’s Guide" class="ltx_ref">Oxs section</a>.</p>
</div>
<div id="p2" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold" style="font-size:120%;">Initialization string format
<br class="ltx_break"></span>
Consider again the simple Specify block presented above:
</p>
<blockquote class="ltx_quote">
<pre class="ltx_verbatim ltx_font_typewriter">
Specify Oxs_EulerEvolve:foo {
  alpha 0.5
  start_dm 0.01
}
</pre>
</blockquote>
<p class="ltx_p">The first convention is that the initialization string be structured as
a Tcl list with an even number of elements, with
consecutive elements consisting of a label + value pairs. In the above
example, the initialization string consists of two label + value pairs,
“alpha 0.5” and “start_dm 0.01”. The first specifies that the
damping parameter <math id="p2.m1" class="ltx_Math" alttext="\alpha" display="inline"><mi>α</mi></math> in the Landau-Lifshitz ODE is 0.5. The
second specifies the initial step size for the integration routine.
Interested parties should refer to a Tcl programming reference (e.g.,
<cite class="ltx_cite ltx_citemacro_cite">[<a href="bibliography.html#bib22" title="Practical programming in Tcl and Tk" class="ltx_ref">32</a>]</cite>) for details on forming a proper Tcl list, but in short
the items are separated by whitespace, and grouped by double quotes or
curly braces (“<code class="ltx_verbatim ltx_font_typewriter">{</code>” and “<code class="ltx_verbatim ltx_font_typewriter">}</code>”). Opening braces and quotes
must be whitespace separated from the preceding text. Grouping
characters are removed during parsing. In this example the list as a
whole is set off with curly braces, and individual elements are white
space delimited. Generally, the ordering of the label + value pairs in
the initialization string is irrelevant, i.e., <span class="ltx_text ltx_font_typewriter">start_dm 0.01</span> could
equivalently precede <span class="ltx_text ltx_font_typewriter">alpha 0.5</span>.</p>
</div>
<div id="p3" class="ltx_para">
<p class="ltx_p">Sometimes the value portion of a label + value pair will itself be a list,
as in this next example:</p>
<blockquote class="ltx_quote">
<p class="ltx_p"><span class="ltx_text ltx_font_typewriter">Specify Oxs_BoxAtlas:myatlas </span>{
<br class="ltx_break"><span class="ltx_text ltx_font_typewriter">
            …
<br class="ltx_break">
</span>}
<br class="ltx_break"><span class="ltx_text ltx_font_typewriter">

<br class="ltx_break">
Specify Oxs_RectangularMesh:mymesh </span>{
<br class="ltx_break"><span class="ltx_text ltx_font_typewriter">
      cellsize </span>{<span class="ltx_text ltx_font_typewriter"> 5e-9 5e-9 5e-9 </span>}
<br class="ltx_break"><span class="ltx_text ltx_font_typewriter">
      atlas Oxs_BoxAtlas:myatlas
<br class="ltx_break">
</span>}</p>
</blockquote>
<p class="ltx_p">Here the value associated with “cellsize” is a list of 3 elements,
which declare the sampling rate along each of the coordinate axes, in
meters. (<span class="ltx_text ltx_font_typewriter">Oxs_BoxAtlas</span> is a particular type of <span class="ltx_text ltx_font_typewriter">Oxs_Atlas</span>,
and “…” mark the location of the <span class="ltx_text ltx_font_typewriter">Oxs_BoxAtlas</span>
initialization string, which is omitted because it is not pertinent to
the present discussion.)</p>
</div>
<div id="p4" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_typewriter ltx_font_bold" style="font-size:120%;">Oxs_Ext<span class="ltx_text ltx_font_serif"> referencing
<br class="ltx_break"></span></span>
The “atlas” value in the mesh Specify block of the preceding example
refers to an earlier <span class="ltx_text ltx_font_typewriter">Oxs_Ext</span> object, “Oxs_BoxAtlas:myatlas”.
It frequently occurs that one <span class="ltx_text ltx_font_typewriter">Oxs_Ext</span> object needs access to
another <span class="ltx_text ltx_font_typewriter">Oxs_Ext</span> object. In this example the mesh object
<span class="ltx_text ltx_font_typewriter">:mymesh</span> needs to query the atlas object <span class="ltx_text ltx_font_typewriter">:myatlas</span> in order to
know the extent of the space that is to be gridded. The atlas object is
defined earlier in the MIF input file by its own, separate, top-level
Specify block, and the mesh object refers to it by simply specifying its
name. Here the full name is used, but the short form <span class="ltx_text ltx_font_typewriter">:myatlas</span>
would suffice, provided no other <span class="ltx_text ltx_font_typewriter">Oxs_Ext</span> object has the same short
name.</p>
</div>
<div id="p5" class="ltx_para">
<p class="ltx_p">Alternatively, the <span class="ltx_text ltx_font_typewriter">Oxs_RectangularMesh</span> object could define an
<span class="ltx_text ltx_font_typewriter">Oxs_BoxAtlas</span> object inline:</p>
<blockquote class="ltx_quote">
<p class="ltx_p"><span class="ltx_text ltx_font_typewriter">Specify Oxs_RectangularMesh:mymesh </span>{
<br class="ltx_break"><span class="ltx_text ltx_font_typewriter">
      atlas </span>{
<br class="ltx_break"><span class="ltx_text ltx_font_typewriter">
            Oxs_BoxAtlas </span>{
<br class="ltx_break"><span class="ltx_text ltx_font_typewriter">
                  …
<br class="ltx_break">
            </span>}
<br class="ltx_break"><span class="ltx_text ltx_font_typewriter">
      </span>}
<br class="ltx_break"><span class="ltx_text ltx_font_typewriter">
      cellsize </span>{<span class="ltx_text ltx_font_typewriter"> 5e-9 5e-9 5e-9 </span>}
<br class="ltx_break"><span class="ltx_text ltx_font_typewriter">
</span>}</p>
</blockquote>
<p class="ltx_p">In place of the name of an external atlas object, a
two item list is provided consisting of the type of object (here
<span class="ltx_text ltx_font_typewriter">Oxs_BoxAtlas</span>) and the corresponding initialization
string. The initialization string is provided as a sublist, with the
same format that would be used if that object were initialized via a
separate Specify block.</p>
</div>
<div id="p6" class="ltx_para">
<p class="ltx_p">More commonly, embedded <span class="ltx_text ltx_font_typewriter">Oxs_Ext</span> objects are used to initialize
spatially varying quantities. For
example,
</p>
<blockquote class="ltx_quote">
<pre class="ltx_verbatim ltx_font_typewriter">
Specify Oxs_UniaxialAnisotropy {
  axis { Oxs_RandomVectorField {
           min_norm 1
           max_norm 1
  }}
  K1  { Oxs_UniformScalarField { value 530e3 } }
}
</pre>
</blockquote>
<p class="ltx_p">The magneto-crystalline anisotropy class <span class="ltx_text ltx_font_typewriter">Oxs_UniaxialAnisotropy</span>
supports cellwise varying K1 and anisotropy axis directions. In this
example, the anisotropy axis directions are randomly distributed. To
initialize its internal data structure, <span class="ltx_text ltx_font_typewriter">Oxs_UniaxialAnisotropy</span>
creates a local <span class="ltx_text ltx_font_typewriter">Oxs_RandomVectorField</span> object. This object is
also a child of the <span class="ltx_text ltx_font_typewriter">Oxs_Ext</span> hierarchy, which allows it to be
constructed using the same machinery invoked by the <span class="ltx_text ltx_font_typewriter">Specify</span>
command. However, it is known only to the enclosing
<span class="ltx_text ltx_font_typewriter">Oxs_UniaxialAnisotropy</span> object, and no references to it are
possible, either from other Specify blocks or even elsewhere inside
the same initialization string. Because it cannot be referenced, the
object does not need an instance name. It does need an initialization
string, however, which is given here as the 4-tuple “min_norm 1
max_norm 1”. Notice how the curly braces are nested so that this
4-tuple is presented to the <span class="ltx_text ltx_font_typewriter">Oxs_RandomVectorField</span> initializer as a
single item, while “Oxs_RandomVectorField” and the associated
initialization string are wrapped up in another Tcl list, so that the
value associated with “axis” is parsed at that level as a single item.</p>
</div>
<div id="p7" class="ltx_para">
<p class="ltx_p">The value associated with “K1” is another embedded <span class="ltx_text ltx_font_typewriter">Oxs_Ext</span>
object. In this particular example, K1 is desired uniform (homogeneous)
throughout the simulation region, so the trivial
<span class="ltx_text ltx_font_typewriter">Oxs_UniformScalarField</span> class is used for initialization (to the value
<math id="p7.m1" class="ltx_Math" alttext="530\times 10^{3}" display="inline"><mrow><mn>530</mn><mo>×</mo><msup><mn>10</mn><mn>3</mn></msup></mrow></math> J/m<math id="p7.m2" class="ltx_Math" alttext="{}^{3}" display="inline"><msup><mi></mi><mn>3</mn></msup></math>). In the case of
uniform fields, scalar or vector, a shorthand notation is available that
implicitly supplies a uniform <span class="ltx_text ltx_font_typewriter">Oxs_Ext</span> field class:
</p>
<blockquote class="ltx_quote">
<pre class="ltx_verbatim ltx_font_typewriter">
Specify Oxs_UniaxialAnisotropy {
  axis { 1 0 0 }
  K1  530e3
}
</pre>
</blockquote>
<p class="ltx_p">which is equivalent to
</p>
<blockquote class="ltx_quote">
<pre class="ltx_verbatim ltx_font_typewriter">
Specify Oxs_UniaxialAnisotropy {
  axis { Oxs_UniformVectorField {
           vector { 1 0 0 }
  }}
  K1  { Oxs_UniformScalarField { value 530e3 } }
}
</pre>
</blockquote>
</div>
<div id="p8" class="ltx_para">
<p class="ltx_p">While embedding <span class="ltx_text ltx_font_typewriter">Oxs_Ext</span> objects inside Specify blocks can be
convenient, it is important to remember that such objects are not
available to any other <span class="ltx_text ltx_font_typewriter">Oxs_Ext</span> object—only objects declared via
top-level Specify blocks may be referenced from inside other
Specify blocks. Also, embedded <span class="ltx_text ltx_font_typewriter">Oxs_Ext</span> objects cannot
directly provide user output. Furthermore, the only <span class="ltx_text ltx_font_typewriter">Oxs_Energy</span>
energy objects included in energy and field calculations are those
declared via top-level Specify blocks. For this reason
<span class="ltx_text ltx_font_typewriter">Oxs_Energy</span> terms are invariably created via top-level Specify
blocks, and not as embedded objects.</p>
</div>
<div id="p9" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold" style="font-size:120%;">Grouped lists
<br class="ltx_break"></span>
As noted earlier, sometimes the value portion of a label + value pair
will be a list. Some Oxs objects support <span class="ltx_text ltx_font_italic">grouped lists</span>, which
provide a type of run-length encoding for lists. Consider the sample
list</p>
<pre class="ltx_verbatim ltx_font_typewriter">
   { 1.1  1.2  1.2  1.2  1.2  1.3 }
</pre>
<p class="ltx_p">In a grouped list the middle run of 1.2’s may be represented as a
sublist with a repeat count of 4, like so</p>
<pre class="ltx_verbatim ltx_font_typewriter">
   { 1.1  { 1.2  4 } 1.3 :expand: }
</pre>
<p class="ltx_p">Here the <span class="ltx_text ltx_font_typewriter">:expand:</span> keyword, when appearing as the last element of
the top level list, enables the group expansion mechanism. Any
preceding element, such as {<span class="ltx_text ltx_font_typewriter"> 1.2 4 </span>}, that 1) is a proper
sublist, and 2) has a positive integer as the last element, is treated
as a grouped sublist with repeat count given by the last element. No
element of the top-level list is ever interpreted as a repeat count.
For example, the short form of the list</p>
<pre class="ltx_verbatim ltx_font_typewriter">
   { 1e-9 1e-9 1e-9 1e-9 1e-9 1e-9 }
</pre>
<p class="ltx_p">is</p>
<pre class="ltx_verbatim ltx_font_typewriter">
   { { 1e-9 6 } :expand: }
</pre>
<p class="ltx_p">Note the additional level of brace grouping. Grouped lists may also be
nested, as in this example</p>
<pre class="ltx_verbatim ltx_font_typewriter">
   { 5.0 { 5.1 { 5.2 3 } 5.3 2 } :expand: }
</pre>
<p class="ltx_p">which is equivalent to</p>
<pre class="ltx_verbatim ltx_font_typewriter">
   { 5.0  5.1  5.2  5.2  5.2  5.3  5.1  5.2  5.2  5.2  5.3 }
</pre>
<p class="ltx_p">There are some difficulties with this mechanism when the list components
are strings, such as filenames, that may contain embedded spaces. For
example, consider the list</p>
<pre class="ltx_verbatim ltx_font_typewriter">
   { "file 3" "file 3" "5 file" }
</pre>
<p class="ltx_p">If we tried to write this as</p>
<pre class="ltx_verbatim ltx_font_typewriter">
   { { "file 3" 2 } "5 file" :expand: }
</pre>
<p class="ltx_p">we would find that, because of the nested grouping rules, this grouped
list gets expanded into</p>
<pre class="ltx_verbatim ltx_font_typewriter">
   { file file file file file file "5 file" }
</pre>
<p class="ltx_p">Here the trailing “3” in “file 3” is interpreted as a repeat count.
Following normal Tcl rules, the double quotes are treated as equivalents
to braces for grouping purposes. However, the keyword <span class="ltx_text ltx_font_typewriter">:noexpand:</span>
may be used to disable further expansion, like so</p>
<pre class="ltx_verbatim ltx_font_typewriter">
   { { {"file 3" :noexpand:} 2 } "5 file" :expand: }
</pre>
<p class="ltx_p">The <span class="ltx_text ltx_font_typewriter">:noexpand:</span> keyword placed at the end of a list disables all
group expansion in that list. Although it is an unlikely example,
if one had a flat, i.e., non-grouped list with last element “:expand:”,
then one would have to disable the grouping mechanism that would
otherwise be invoked by appending <span class="ltx_text ltx_font_typewriter">:noexpand:</span> to the list. In
flat lists generated by program code, it is recommended to append
<span class="ltx_text ltx_font_typewriter">:noexpand:</span> just to be certain that the list is not expanded.</p>
</div>
<div id="p10" class="ltx_para">
<p class="ltx_p">As a matter of nomenclature, standard (i.e., flat) lists and single
values are also considered grouped lists, albeit trivial ones. Any Oxs
object that accepts grouped lists in its Specify block should explicitly
state so in its documentation.</p>
</div>
<div id="p11" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold" style="font-size:120%;">Comments
<br class="ltx_break"></span>
The standard Tcl commenting mechanism treats all text running from an
initial <span class="ltx_text ltx_font_typewriter">#</span> symbol through to the end of a line as a comment. You may
note in the above examples that newlines are treated the same as
other whitespace inside the curly braces delimiting the <span class="ltx_text ltx_font_typewriter">Specify</span>
initialization string. Because of this and additional reasons, Tcl comments cannot be used inside Specify blocks. Instead, by
convention any label + value pair where label is “comment” is treated
as a comment and thrown away. For example:
</p>
<blockquote class="ltx_quote">
<pre class="ltx_verbatim ltx_font_typewriter">
Specify Oxs_UniaxialAnisotropy {
  axis { 1 0 0 }
  comment {K1  4500e3}
  K1 530e3
  comment { 530e3 J/m^3 is nominal for Co }
}
</pre>
</blockquote>
<p class="ltx_p">Pay attention to the difference between “comment” used here as the
label portion of a label + value pair, and the MIF extension command
“Ignore” used outside Specify blocks. In particular, <span class="ltx_text ltx_font_typewriter">Ignore</span>
takes an arbitrary number of arguments, but the value element associated
with a comment label must be grouped as a single element, just as any
other value element.</p>
</div>
<div id="p12" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold" style="font-size:120%;">Attributes
<br class="ltx_break"></span>
Sometimes it is convenient to define label + value pairs outside a
particular Specify block, and then import them using the
“attributes” label. For example:
</p>
<blockquote class="ltx_quote">
<pre class="ltx_verbatim ltx_font_typewriter">
Specify Oxs_LabelValue:probdata {
  alpha 0.5
  start_dm 0.01
}

Specify Oxs_EulerEvolve {
  attributes :probdata
}
</pre>
</blockquote>
<p class="ltx_p">The <span class="ltx_text ltx_font_typewriter">Oxs_LabelValue</span> object is an <span class="ltx_text ltx_font_typewriter">Oxs_Ext</span> class that does
nothing except hold label + value pairs. The “attributes” label acts as an
include statement, causing the label + value pairs contained in the
specified <span class="ltx_text ltx_font_typewriter">Oxs_LabelValue</span> object to be embedded into the enclosing
<span class="ltx_text ltx_font_typewriter">Specify</span> initialization string. This technique is most useful if the
label + value pairs in the <span class="ltx_text ltx_font_typewriter">Oxs_LabelValue</span> object are used in
multiple Specify blocks, either inside the same MIF file, or
across several MIF files into which the <span class="ltx_text ltx_font_typewriter">Oxs_LabelValue</span> block is
imported using the <span class="ltx_text ltx_font_typewriter">ReadFile</span> MIF extension command.</p>
</div>
<div id="p13" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold" style="font-size:120%;">User defined support procedures
<br class="ltx_break"></span>
A number of <span class="ltx_text ltx_font_typewriter">Oxs_Ext</span> classes utilize user-defined Tcl procedures (procs) to provide extended runtime functionality. The
most common examples are the various field initialization script
classes, which call a user specified Tcl proc for each point in the
simulation discretization mesh. The proc returns a value, either
scalar or vector, which is interpreted as some property of the
simulation at that point in space, such as saturation magnetization,
anisotropy properties, or an external applied field.</p>
</div>
<div id="p14" class="ltx_para">
<p class="ltx_p">Here is an example proc that may be used to set the initial
magnetization configuration into an approximate vortex state, with a
central core in the positive <math id="p14.m1" class="ltx_Math" alttext="z" display="inline"><mi>z</mi></math> direction:
</p>
<blockquote class="ltx_quote">
<pre class="ltx_verbatim ltx_font_typewriter">
proc Vortex { x_rel y_rel z_rel } {
   set xrad [expr {$x_rel-0.5}]
   set yrad [expr {$y_rel-0.5}]
   set normsq [expr {$xrad*$xrad+$yrad*$yrad}]
   if {$normsq &lt;= 0.0125} {return "0 0 1"}
   return [list [expr {-1*$yrad}] $xrad 0]
}
</pre>
</blockquote>
<p class="ltx_p">The return value in this case is a 3D vector representing the spin
direction at the point <span class="ltx_text ltx_font_typewriter">(x_rel,y_rel,z_rel)</span>. Procs
that are used to set scalar properties, such as saturation
magnetization <math id="p14.m2" class="ltx_Math" alttext="M_{s}" display="inline"><msub><mi>M</mi><mi>s</mi></msub></math>, return a scalar value instead. But in both
cases, the import argument list specifies a point in the simulation
mesh.</p>
</div>
<div id="p15" class="ltx_para">
<p class="ltx_p">In the above example, the import point is specified relative to the
extents of the simulation mesh. For example, if <span class="ltx_text ltx_font_typewriter">x_rel</span> were
0.1, then the <math id="p15.m1" class="ltx_Math" alttext="x" display="inline"><mi>x</mi></math>-coordinate of the point is one tenth of the way
between the minimum <math id="p15.m2" class="ltx_Math" alttext="x" display="inline"><mi>x</mi></math> value in the simulation and the maximum <math id="p15.m3" class="ltx_Math" alttext="x" display="inline"><mi>x</mi></math>
value. In all cases <span class="ltx_text ltx_font_typewriter">x_rel</span> will have a value between 0 and
1.</p>
</div>
<div id="p16" class="ltx_para">
<p class="ltx_p">In most support proc examples, relative coordinates are the most
flexible and easiest representation to work with. However, by
convention, scripting <span class="ltx_text ltx_font_typewriter">Oxs_Ext</span> classes also support absolute
coordinate representations. The representation used is selected in the
<span class="ltx_text ltx_font_typewriter">Oxs_Ext</span> object Specify block by the optional <span class="ltx_text ltx_font_typewriter">script_args</span>
entry. The Tcl proc itself is specified by the <span class="ltx_text ltx_font_typewriter">script</span> entry,
as seen in this example:
</p>
<blockquote class="ltx_quote">
<pre class="ltx_verbatim ltx_font_typewriter">
proc SatMag { x y z } {
   if {$z &lt; 20e-9} {return 8e5}
   return 5e5
}

Specify ScriptScalarField:Ms {
   atlas :atlas
   script_args { rawpt }
   script SatMag
}
</pre>
</blockquote>
<p class="ltx_p">The value associated with the label <span class="ltx_text ltx_font_typewriter">script_args</span> should in this
case be a subset of {<span class="ltx_text ltx_font_typewriter">relpt rawpt minpt maxpt span scalars
vectors</span>}, as explained in the
<a href="sec_oxsFieldObjects.html#item:ScriptScalarField" title="item Oxs_ScriptScalarField: ‣ 7.3.6 Field Objects ‣ 7.3 Standard Oxs_Ext Child Classes ‣ Chapter 7 OOMMF eXtensible Solver ‣ OOMMF User’s Guide" class="ltx_ref ltx_font_typewriter">Oxs_ScriptScalarField</a>
documentation (page <a href="sec_oxsFieldObjects.html#item:ScriptScalarField" title="item Oxs_ScriptScalarField: ‣ 7.3.6 Field Objects ‣ 7.3 Standard Oxs_Ext Child Classes ‣ Chapter 7 OOMMF eXtensible Solver ‣ OOMMF User’s Guide" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.3.6</span></a>). Here
<span class="ltx_text ltx_font_typewriter">rawpt</span> provides the point representation in problem coordinates,
i.e., in meters. Other <span class="ltx_text ltx_font_typewriter">Oxs_Ext</span> objects support a different list
of allowed <span class="ltx_text ltx_font_typewriter">script_args</span> values. Check the documentation of the
<span class="ltx_text ltx_font_typewriter">Oxs_Ext</span> object in question for details. Please note that the
names used in the proc argument lists above are for exposition purposes
only. You may use other names as you wish. It is the order of the
arguments that is important, not their names. Also, MIF 2.1 files are
parsed first in toto before the Specify blocks are evaluated, so the
support procs may be placed anywhere in a MIF 2.1 file, regardless of
the location of the referencing Specify blocks. Conversely,
<a href="sec_mif22format.html" title="17.4 MIF 2.2 ‣ Chapter 17 Problem Specification File Formats (MIF) ‣ OOMMF User’s Guide" class="ltx_ref">MIF 2.2</a>
files are parsed in a single pass, with Specify blocks evaluated as they
are read. Therefore for MIF 2.2 files it is generally best to place
proc definitions ahead of Specify blocks in which they are referenced.</p>
</div>
<div id="p17" class="ltx_para">
<p class="ltx_p">The command call to the Tcl support proc is actually built up by
appending to the <span class="ltx_text ltx_font_typewriter">script</span> value the arguments as specified by the
<span class="ltx_text ltx_font_typewriter">script_args</span> value. This allows additional arguments to the
Tcl proc to be specified in the <span class="ltx_text ltx_font_typewriter">script</span> value, in which case
they will appear in the argument list in front of the
<span class="ltx_text ltx_font_typewriter">script_args</span> values. The following is equivalent to the
preceding example:
</p>
<blockquote class="ltx_quote">
<pre class="ltx_verbatim ltx_font_typewriter">
proc SatMag { zheight Ms1 Ms2 x y z } {
   if {$z &lt; $zheight} {return $Ms1}
   return $Ms2
}

Specify ScriptScalarField:Ms {
   script_args { rawpt }
   script {SatMag 20e-9 8e5 5e5}
}
</pre>
</blockquote>
<p class="ltx_p">Notice in this case that the <span class="ltx_text ltx_font_typewriter">script</span> value is wrapped in curly
braces so that the string <span class="ltx_text ltx_font_typewriter">SatMag 20e-9 8e5 5e5</span> will be treated as
the single value associated with the label <span class="ltx_text ltx_font_typewriter">script</span>.</p>
</div>
<div id="p18" class="ltx_para">
<p class="ltx_p">As seen in the earlier example using the <span class="ltx_text ltx_font_typewriter">Vortex</span> Tcl proc,
support procedures in MIF 2.1 files will frequently make use of the
Tcl <span class="ltx_text ltx_font_typewriter">expr</span> command. If you are using Tcl version 8.0 or later,
then the cpu time required by the potentially large number of calls to
such procedures can be greatly reduced by grouping the arguments to
<span class="ltx_text ltx_font_typewriter">expr</span> commands in curly braces, as illustrated in the
<span class="ltx_text ltx_font_typewriter">Vortex</span> example. The braces aid the operation of the Tcl byte code compiler, although there are a few rare situations involving
multiple substitution where such bracing cannot be applied. See the
Tcl documentation for the <span class="ltx_text ltx_font_typewriter">expr</span> command for details.</p>
</div>
<div id="p19" class="ltx_para">
<p class="ltx_p">Sometimes externally defined data can be put to good use inside a
Tcl support proc, as in this example:
</p>
<blockquote class="ltx_quote">
<pre class="ltx_verbatim ltx_font_typewriter">
# Lay out a 6 x 16 mask, at global scope.
set mask {
   1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
   1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
   1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
   1 1 1 1 1 0 0 0 0 0 0 1 1 1 1 1
   1 1 1 1 1 0 0 0 0 0 0 1 1 1 1 1
   1 1 1 1 1 0 0 0 0 0 0 1 1 1 1 1
}

proc MyShape { xrel yrel znotused } {
   global mask  ;# Make mask accessible inside proc
   set Ms 8e5   ;# Saturation magnetization of element
   set xindex [expr {int(floor($xrel*16))}]
   set yindex [expr {5 - int(floor($yrel*6))}]
   set index [expr {$yindex*16+$xindex}]
   # index references point in mask corresponding
   # to (xrel,yrel)
   return [expr {[lindex $mask $index]*$Ms}]
}
</pre>
</blockquote>
<p class="ltx_p">The variable <span class="ltx_text ltx_font_typewriter">mask</span> holds a Tcl list of 0’s and 1’s defining a part
shape. The mask is brought into the scope of the <span class="ltx_text ltx_font_typewriter">MyShape</span> proc via
the Tcl <span class="ltx_text ltx_font_typewriter">global</span> command. The relative <math id="p19.m1" class="ltx_Math" alttext="x" display="inline"><mi>x</mi></math> and <math id="p19.m2" class="ltx_Math" alttext="y" display="inline"><mi>y</mi></math> coordinates are
converted into an index into the list, and the proc return value is
either 0 or 8e5 depending on whether the corresponding point in the mask
is 0 or 1. This is essentially the same technique used in the
<span class="ltx_text ltx_font_typewriter">ColorField</span> proc example presented in the
<a href="sec_mif2ExtensionCommands.html#html:ReadFile" title="item ReadFile ‣ 17.3.2 MIF 2.1 Extension Commands ‣ 17.3 MIF 2.1 ‣ Chapter 17 Problem Specification File Formats (MIF) ‣ OOMMF User’s Guide" class="ltx_ref ltx_font_typewriter">ReadFile</a> MIF extension command
documented above (Sec. <a href="sec_mif2ExtensionCommands.html" title="17.3.2 MIF 2.1 Extension Commands ‣ 17.3 MIF 2.1 ‣ Chapter 17 Problem Specification File Formats (MIF) ‣ OOMMF User’s Guide" class="ltx_ref"><span class="ltx_text ltx_ref_tag">17.3.2</span></a>),
except that there the data structure values are built from a separate
image file rather than from data embedded inside the MIF file.
</p>
</div>
<div id="p20" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold" style="font-size:120%;">User defined scalar outputs
<br class="ltx_break"></span>
OOMMF <span class="ltx_text ltx_font_typewriter">Oxs_Ext</span> objects support a general method to allow users to
define scalar (DataTable) outputs derived from vector field outputs.
These scalar outputs are defined by “<span class="ltx_text ltx_font_typewriter">user_output</span>” sub-blocks inside
Specify blocks. The format is:
</p>
<blockquote class="ltx_quote">
<p class="ltx_p"><span class="ltx_text ltx_font_typewriter">user_output </span>{
<br class="ltx_break"><span class="ltx_text ltx_font_typewriter">
      name </span><span class="ltx_text ltx_font_italic">output_name
<br class="ltx_break"></span><span class="ltx_text ltx_font_typewriter">
      source_field </span><span class="ltx_text ltx_font_italic">source
<br class="ltx_break"></span><span class="ltx_text ltx_font_typewriter">
      select_field </span><span class="ltx_text ltx_font_italic">weighting
<br class="ltx_break"></span><span class="ltx_text ltx_font_typewriter">
      normalize </span><span class="ltx_text ltx_font_italic">norm_request
<br class="ltx_break"></span><span class="ltx_text ltx_font_typewriter">
      exclude_0_Ms </span><span class="ltx_text ltx_font_italic">novacuum
<br class="ltx_break"></span><span class="ltx_text ltx_font_typewriter">
      user_scaling </span><span class="ltx_text ltx_font_italic">scale
<br class="ltx_break"></span><span class="ltx_text ltx_font_typewriter">
      units </span><span class="ltx_text ltx_font_italic">units
<br class="ltx_break"></span><span class="ltx_text ltx_font_typewriter">
</span>}</p>
</blockquote>
<p class="ltx_p">The first parameter, <span class="ltx_text ltx_font_bold">name</span>, specifies the label attached to
this output in the DataTable results; the full name will be the Specify
block instance name, followed by <span class="ltx_text ltx_font_italic">:output_name</span>. This label
must follow the rules for ODT column labels; in particular, embedded
newlines and carriage returns are not allowed.</p>
</div>
<div id="p21" class="ltx_para">
<p class="ltx_p">The second parameter, <span class="ltx_text ltx_font_bold">source_field</span>, specifies the vector
field output that the output is derived from. The <span class="ltx_text ltx_font_italic">source</span> value
should match the label for the source field output as displayed in the
“Output” pane of the Oxsii or Boxsi interactive interface; this can
also be found in the documentation for the source field <span class="ltx_text ltx_font_typewriter">Oxs_Ext</span>
class. If the source field is from the same class as the user output,
then <span class="ltx_text ltx_font_italic">source</span> can use the short form of the name (i.e., the
component following the last “:”); otherwise the full name must be
used.</p>
</div>
<div id="p22" class="ltx_para">
<p class="ltx_p">The third parameter, <span class="ltx_text ltx_font_bold">select_field</span>, references a field that
is used to weight the source field to create the scalar output. The
output is computed according to</p>
<table id="eq:UserScalarOutput" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Ch17.E1.m1" class="ltx_Math" alttext="\sum_{i}W_{\rm select}[i]\cdot V_{\rm source}[i]/\sum_{i}\|W_{\rm select}[i]\|" display="block"><mrow><munder><mo largeop="true" movablelimits="false" symmetric="true">∑</mo><mi>i</mi></munder><mrow><mrow><mrow><mrow><msub><mi>W</mi><mi>select</mi></msub><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow></mrow><mo>⋅</mo><msub><mi>V</mi><mi>source</mi></msub></mrow><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow></mrow><mo>/</mo><mrow><munder><mo largeop="true" movablelimits="false" symmetric="true">∑</mo><mi>i</mi></munder><mrow><mo>∥</mo><mrow><msub><mi>W</mi><mi>select</mi></msub><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow></mrow><mo>∥</mo></mrow></mrow></mrow></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(17.1)</span></td>
</tr>
</table>
<p class="ltx_p">where the sums are across all cells in the simulation, <math id="p22.m1" class="ltx_Math" alttext="W_{\rm select}[i]" display="inline"><mrow><msub><mi>W</mi><mi>select</mi></msub><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow></mrow></math> is the value of the select field at cell <math id="p22.m2" class="ltx_Math" alttext="i" display="inline"><mi>i</mi></math>,
<math id="p22.m3" class="ltx_Math" alttext="V_{\rm source}[i]" display="inline"><mrow><msub><mi>V</mi><mi>source</mi></msub><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow></mrow></math> is the value of the source field at cell <math id="p22.m4" class="ltx_Math" alttext="i" display="inline"><mi>i</mi></math>,
and “<math id="p22.m5" class="ltx_Math" alttext="\cdot" display="inline"><mo>⋅</mo></math>” indicates the scalar (dot) product.</p>
</div>
<div id="p23" class="ltx_para">
<p class="ltx_p">The first three parameters are required, the remaining parameters are
optional. The first of the optional parameters, <span class="ltx_text ltx_font_bold">normalize</span>,
affects the denominator in (<a href="#eq:UserScalarOutput" title="(17.1) ‣ 17.3.3 Specify Conventions ‣ 17.3 MIF 2.1 ‣ Chapter 17 Problem Specification File Formats (MIF) ‣ OOMMF User’s Guide" class="ltx_ref"><span class="ltx_text ltx_ref_tag">17.1</span></a>). If
<span class="ltx_text ltx_font_italic">norm_request</span> is 1 (the default), then the output is computed
as shown in (<a href="#eq:UserScalarOutput" title="(17.1) ‣ 17.3.3 Specify Conventions ‣ 17.3 MIF 2.1 ‣ Chapter 17 Problem Specification File Formats (MIF) ‣ OOMMF User’s Guide" class="ltx_ref"><span class="ltx_text ltx_ref_tag">17.1</span></a>). If <span class="ltx_text ltx_font_italic">norm_request</span> is 0,
then instead the denominator is replaced with the number of cells in the
simulation, i.e., <math id="p23.m1" class="ltx_Math" alttext="\sum_{i}1" display="inline"><mrow><msub><mo largeop="true" symmetric="true">∑</mo><mi>i</mi></msub><mn>1</mn></mrow></math>.</p>
</div>
<div id="p24" class="ltx_para">
<p class="ltx_p">The second optional parameter, <span class="ltx_text ltx_font_bold">exclude_0_Ms</span>, is a
convenience operator; if <span class="ltx_text ltx_font_italic">novacuum</span> is 1, then the select field
is reset so that it is the zero vector at all cells in the simulation
where the saturation magnetization is zero. This is especially useful
when you want to compute the average magnetization of a shaped part.
The change to the select field is made before the denominator in
(<a href="#eq:UserScalarOutput" title="(17.1) ‣ 17.3.3 Specify Conventions ‣ 17.3 MIF 2.1 ‣ Chapter 17 Problem Specification File Formats (MIF) ‣ OOMMF User’s Guide" class="ltx_ref"><span class="ltx_text ltx_ref_tag">17.1</span></a>) is computed, so setting
<span class="ltx_text ltx_font_bold">exclude_0_Ms</span> to 1 is equivalent to defining the select
field as being zero where <math id="p24.m1" class="ltx_Math" alttext="M_{s}" display="inline"><msub><mi>M</mi><mi>s</mi></msub></math> is zero in the first place. The default
value for this parameter is 0, which results in the select field being
used exactly as defined.</p>
</div>
<div id="p25" class="ltx_para">
<p class="ltx_p">The <span class="ltx_text ltx_font_bold">user_scaling</span> parameter (default value 1.0) allows the
user to define a constant factor that is multiplied against the result
of (<a href="#eq:UserScalarOutput" title="(17.1) ‣ 17.3.3 Specify Conventions ‣ 17.3 MIF 2.1 ‣ Chapter 17 Problem Specification File Formats (MIF) ‣ OOMMF User’s Guide" class="ltx_ref"><span class="ltx_text ltx_ref_tag">17.1</span></a>). This can be used, for example, in
conjuction with the <span class="ltx_text ltx_font_bold">units</span> parameter to implement unit
conversion. The <span class="ltx_text ltx_font_italic">units</span> value is an arbitrary string (for
example, A/m) that is placed in the DataTable output. This label must
follow the rules for ODT unit labels; in particular, embedded newlines
and carriage returns are not allowed. If <span class="ltx_text ltx_font_italic">units</span> is not set,
then the units string is copied from the units for the source field.</p>
</div>
<div id="p26" class="ltx_para">
<p class="ltx_p">The following is a simple example showing two user outputs based
off the demagnetization field:
</p>
<blockquote class="ltx_quote">
<pre class="ltx_verbatim ltx_font_typewriter">
Specify Oxs_BoxAtlas:atlas [subst {
  xrange {0 $cube_edge}
  yrange {0 $cube_edge}
  zrange {0 $cube_edge}
}]

Specify Oxs_BoxAtlas:octant [subst {
  xrange {0 [expr {$cube_edge/2.}]}
  yrange {0 [expr {$cube_edge/2.}]}
  zrange {0 [expr {$cube_edge/2.}]}
}]

Specify Oxs_AtlasVectorField:octant_field_y {
   atlas :octant
   default_value {0 0 0}
   values {
      octant {0 1 0}
   }
}

Specify Oxs_Demag {
  user_output {
     name "Hdemag_x"
     source_field Field
     select_field {1 0 0}
  }
  user_output {
     name "octant Hdemag_y"
     source_field Field
     select_field :octant_field_y
  }
}
</pre>
</blockquote>
<p class="ltx_p">The first user output, “<span class="ltx_text ltx_font_typewriter">Hdemag_x</span>,” returns the
<math id="p26.m1" class="ltx_Math" alttext="x" display="inline"><mi>x</mi></math>-component of the demagnetization field, averaged across the entire
simulation volume. This output will appear in DataTable output with the
label “<span class="ltx_text ltx_font_typewriter">Oxs_Demag::Hdemag_x</span>.” The <span class="ltx_text ltx_font_typewriter">source_field</span> parameter
“Field” refers to the “Field” output of the surrounding
<span class="ltx_text ltx_font_typewriter">Oxs_Ext</span> object, which here means <span class="ltx_text ltx_font_typewriter">Oxs_Demag::Field</span>.
The select field is <math id="p26.m2" class="ltx_Math" alttext="(1,0,0)" display="inline"><mrow><mo stretchy="false">(</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></math>, uniform across the simulation volume.
The second output, “<span class="ltx_text ltx_font_typewriter">octant Hdemag_y</span>,” is similar, but the
average is of the <math id="p26.m3" class="ltx_Math" alttext="y" display="inline"><mi>y</mi></math> component of the demagnetization field, and is
averaged across only the first octant of the simulation volume. The
averaging volume and component selection are defined by the
<span class="ltx_text ltx_font_typewriter">:octant_field_y</span> field object, which is <math id="p26.m4" class="ltx_Math" alttext="(0,1,0)" display="inline"><mrow><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></math> in the first
octant and <math id="p26.m5" class="ltx_Math" alttext="(0,0,0)" display="inline"><mrow><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></math> everywhere else.</p>
</div>
<div id="p27" class="ltx_para">
<p class="ltx_p">The source code for user defined scalar outputs can be found in the
files <span class="ltx_text ltx_font_typewriter">ext.h</span> and <span class="ltx_text ltx_font_typewriter">ext.cc</span> in the directory
<span class="ltx_text ltx_font_typewriter">oommf/app/oxs/base/</span>. Example MIF files include <span class="ltx_text ltx_font_typewriter">cube.mif</span>,
<span class="ltx_text ltx_font_typewriter">pbcbrick.mif</span>, <span class="ltx_text ltx_font_typewriter">spinvalve.mif</span>, and <span class="ltx_text ltx_font_typewriter">stdprob2.mif</span> in
<span class="ltx_text ltx_font_typewriter">oommf/app/oxs/examples/</span>.</p>
</div>
</section>
</div>
<footer class="ltx_page_footer">
<div>
<a href="sec_mif2ExtensionCommands.html" title="17.3.2 MIF 2.1 Extension Commands ‣ 17.3 MIF 2.1 ‣ Chapter 17 Problem Specification File Formats (MIF) ‣ OOMMF User’s Guide" class="ltx_ref" rel="prev"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">17.3.2 </span>MIF 2.1 Extension Commands</span></a><a href="sec_varSubst.html" title="17.3.4 Variable Substitution ‣ 17.3 MIF 2.1 ‣ Chapter 17 Problem Specification File Formats (MIF) ‣ OOMMF User’s Guide" class="ltx_ref" rel="next"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">17.3.4 </span>Variable Substitution</span></a><a href="index.html" title="Index ‣ OOMMF User’s Guide" class="ltx_ref" rel="index"><span class="ltx_text ltx_ref_title">Index</span></a>
</div></footer>
</div>
</body>
</html>
